<h1 align="center" style="max-width: 100%;">
  <img width="1100" alt="Logo" src="README.assets/Logo.png" style="max-width: 100%;" /><br/>
  <a href="https://www.prismfilmstudio.com">www.prismfilmstudio.com(ë°°í¬ì¤‘ì§€)</a>
</h1>




<h3 align="center">
 í”„ë¡œì íŠ¸ ìµœìš°ìˆ˜ìƒ (1ë“±) ìˆ˜ìƒ - ì‚¼ì„±ì „ì<br /></h3>




###                                  

<p align="center">
  <b> </b><br /></p>



<p align="center">
  <b>Supported</b><br/>
  <a href="#"><img width="45" src="https://blog.kakaocdn.net/dn/cVaSOX/btqD9jVw36X/jHpIEqn2EAk7xdKMMmpEP0/img.png" alt="C#" /></a>&nbsp;&nbsp;
  <a href="#"><img width="45" src="https://filestore.community.support.microsoft.com/api/images/a7899ec5-bd4c-4b38-9233-173397ef577f?upload=true" alt="Python" /></a>&nbsp;&nbsp;
  <a href="#"><img width="45" src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Python-logo-notext.svg/768px-Python-logo-notext.svg.png" alt="JS" /></a>&nbsp;&nbsp;
  <a href="#"><img width="45" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Unofficial_JavaScript_logo_2.svg/1200px-Unofficial_JavaScript_logo_2.svg.png" alt="Preact" /></a>&nbsp;&nbsp;
  <a href="#"><img width="45" src="https://media.vlpt.us/images/ec532/post/bc893d61-4eaa-4f8f-9b2c-e2d2143506a4/aws_ec2.svg" alt="EC2" /></a>
</p>



<table style="table-layout: fixed; overflow-wrap: break-word;">
  <tbody>
    <tr>
      <td><a href="#" target="_blank"><img width="500" src="README.assets/voice.gif" alt="iPhone demo" style="max-width: 100%;" /></a></td>
      <td><a href="#" target="_blank"><img width="500" src="README.assets/choice.gif" alt="Music app demo" style="max-width: 100%;" /></a></td>
      <td rowspan="2" style="display:flex-column;"><img height="250" src="README.assets/detail3.gif" alt="Full page demo" style="max-width: 100%;" /><div style="height:15px;"></div></div><img height="250" src="README.assets/draw5.png" alt="Full page demo" style="max-width: 100%;" /></td>
    </tr>
    <tr>
      <td colspan="2"><a href="#" target="_blank"><img width="1000" src="README.assets/main5.png" alt="Parallax demo" style="max-width: 100%;" /></a></td>
    </tr>
  </tbody>
</table>
<h6 align="center">
  www.prismfilmstudio.com <a href="#"></a>
</h6>

<br>

## ğŸ’ğŸ» About Project

#### ê²½í—˜í•˜ê³ , ì„±ì¥í•œ ê²ƒë“¤ (2021.09 ~ 2021.11)

- ERD ì„¤ê³„ ë° ì˜¤í”ˆ APIë¥¼ í™œìš©í•œ ë°ì´í„° ì¬êµ¬ì„±
- Python, Django ORMì„ í™œìš©í•œ ë°ì´í„° ì£¼ì…
- Blob ë°ì´í„°ë¥¼ í™œìš©í•œ ë“œë¡œì‰ ë¦¬ë·° ë° í€´ì¦ˆ ê¸°ëŠ¥ êµ¬í˜„
- Web Speech API ë° Ajax í†µì‹ ì„ í™œìš©í•œ ìŒì„±ì¸ì‹ êµ¬í˜„
- ë°ì´í„°ë² ì´ìŠ¤ ìºì‹±ì„ í™œìš©í•œ ì¿¼ë¦¬ ìµœì í™”
- AWS(EC2), Nginx, Gunicorn, Cloud9ì„ í™œìš©í•œ ë°°í¬



#### ì‚¬ìš© ê¸°ìˆ  ìš”ì•½

- Python, Django, Django ORM
- Django Template, HTML5, CSS3, JS(ES6)
- Gunicorn, Nginx, AWS, EC2, Cloud9, HTTPS




-----

<br>

## âœ¨ Stack

### ì£¼ìš”  Stack

|                        Content                         |           Main            |                          Detail                          |
| :----------------------------------------------------: | :-----------------------: | :------------------------------------------------------: |
|               [**ìŒì„±ì¸ì‹**](#ìŒì„±ì¸ì‹ )               | Python 3.9.6 / JavaScript |             webkitSpeechRecognition / Axios              |
|                 [**ë“œë¡œì‰**](#ë“œë¡œì‰)                  |        JavaScript         |                Canvas / Blob Data/ Axios                 |
|                       [**FE**]()                       |  HTML / CSS / JavaScript  |            Django 3.2.9 / HTML5 / CSS3 / ES6             |
|         [**í´ëŸ¬ìŠ¤í„°ë§**](#ìƒ‰ì±„-ë°ì´í„°-ë§Œë“¤ê¸°)          |  C# .Net Framework 4.7.2  |            C#(OpenCvSharp4 - V4.5.3.20210817)            |
| [**RGB Calculating**](#ì•Œê³ ë¦¬ì¦˜-êµ¬ì„±-ë°-ì›¹í˜ì´ì§€-ì‘ì—…) |       Python 3.9.6        |                       Python(Math)                       |
|                     [**DB**](#db)                      |       Python 3.9.6        |                    Python(Shell_plus)                    |
|           [**Query ìµœì í™”**](#query-ìµœì í™”)            |       Django 3.2.9        |      prefetch_related / annotate / filter / exclude      |
|                   [**ë°°í¬**](#ë°°í¬)                    |            AWS            | EC2(Ubuntu Server 18.04 LTS) / Cloud9 / Gunicorn / NGINX |

<br>

### ê¸°ë³¸ Stack

|       ent        |      Page       |                         Description                          |
| :--------------: | :-------------: | :----------------------------------------------------------: |
|       User       |    accounts/    |                 íšŒì›ê°€ì… / ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ                 |
|   ì˜ˆê³ í¸ ë³´ê¸°    |     detail/     |          ì˜í™” í¬ìŠ¤í„° ëˆ„ë¥¼ ì‹œ, ì˜ˆê³ í¸ íŒì—… ìë™ì¬ìƒ           |
|   ìƒ‰ì±„ ê³ ë¥´ê¸°    |     choice/     |                  ì¶”ì²œ ë°›ê³  ì‹¶ì€ ìƒ‰ì±„ ê³ ë¥´ê¸°                  |
|   í‰ì ìˆœ ì •ë ¬    |      base/      | TMDB í‰ì  ìˆœìœ¼ë¡œ ì •ë ¬ / í•œì¤„í‰\|ë¦¬ë·° ë‚¨ê¸¸ì‹œ ì¶”ì²œ ì•ˆí•˜ë„ë¡ êµ¬ì„± |
|   ìµœì‹ ìˆœ ì •ë ¬    |      base/      | ê°œë´‰ì¼ ìµœì‹  ìˆœìœ¼ë¡œ ì •ë ¬ / í•œì¤„í‰\|ë¦¬ë·° ë‚¨ê¸¸ì‹œ ì¶”ì²œ ì•ˆí•˜ë„ë¡ êµ¬ì„± |
| ì´ì „ ìƒ‰ì±„ë¡œ ì •ë ¬ |      base/      | AI Z Score ìˆœìœ¼ë¡œ ì •ë ¬ / í•œì¤„í‰\|ë¦¬ë·° ë‚¨ê¸¸ì‹œ ì¶”ì²œ ì•ˆí•˜ë„ë¡ êµ¬ì„± |
| ì‚¬ìš©ì í‰ê·  í‰ì  |     detail/     |        ì˜í™”ì— ëŒ€í•´ ìœ ì €ê°€ ë‚¨ê¸´ í‰ê·  í‰ì  ê³„ì‚° ë° ì¶œë ¥        |
| ì˜í™” í‚¤ì›Œë“œ ê²€ìƒ‰ |      base/      | ê²€ìƒ‰ ê¸°ëŠ¥ìœ¼ë¡œ ì œëª© > ë‚´ìš©ì— í‚¤ì›Œë“œ í¬í•¨ì—¬ë¶€ì— ë”°ë¼ ì •ë ¬í•´ì„œ ì¶œë ¥ |
|   í€´ì¦ˆ ë§Œë“¤ê¸°    |  quiz_create/   |      ì‚¬ìš©ìê°€ ì˜í™”ì— ëŒ€í•œ ê·¸ë¦¼ í€´ì¦ˆë¥¼ ë‚¼ ìˆ˜ ìˆë„ë¡ êµ¬ì„±      |
|    í€´ì¦ˆ í’€ê¸°     |      quiz/      | ì‚¬ìš©ìë“¤ë¼ë¦¬ ë¬¸ì œë¥¼ í’€ê³  í‹°ì–´ì— ëŒ€í•œ ì ìˆ˜ë¥¼ ì–»ì„ ìˆ˜ ìˆë„ë¡ êµ¬ì„± |
|  í‰ì  ë° í•œì¤„í‰  | movie_comment/  |       ì˜í™”ì— ëŒ€í•œ ë³„ì ê³¼ í•œì¤„í‰ì„ ë‚¨ê¸¸ ìˆ˜ ìˆë„ë¡ êµ¬ì„±        |
|   ë¦¬ë·°(+ê·¸ë¦¼)    |     review/     |           ê·¸ë¦¼ì„ ê·¸ë¦¬ë©° ë¦¬ë·°ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆë„ë¡ êµ¬ì„±           |
|   ë¦¬ë·° ì† ëŒ“ê¸€   | review_comment/ |             ë¦¬ë·°ë§ˆë‹¤ ëŒ“ê¸€ì„ ë‚¨ê¸¸ ìˆ˜ ìˆë„ë¡ êµ¬ì„±              |
|    ìœ ì € í‹°ì–´     |      tier/      | ë¸Œë¡ ì¦ˆë¶€í„° ë§ˆìŠ¤í„°ê¹Œì§€ ë¦¬ë·° ì‘ì„±, ë¬¸ì œ í’€ì´ ë“±ì—ì„œ ì ìˆ˜ íšë“  |
| ì˜í™” Frame í™•ëŒ€  |     detail/     | detail í˜ì´ì§€ì—ì„œ ì˜í™”ì— ëŒ€í•œ í”„ë ˆì„ í´ë¦­ì‹œ  Modalë¡œ í™•ëŒ€ ì¶œë ¥ |

<br>

## ğŸ“¦ ERD ì„¤ê³„ ë° ì˜¤í”ˆ APIë¥¼ í™œìš©í•œ ë°ì´í„° ì¬êµ¬ì„±

![erd](README.assets/erd-7816963.png)

### ìœ ì €

- Django AbstractUser ìƒì†
- ìœ ì € ë“±ê¸‰ì— ëŒ€í•œ point ë¶€ë¶„ Custom
- ì˜í™”ë¥¼ ì˜¬ë¦´ ìˆ˜ ì—†ê³ , í•œì¤„í‰ê³¼ ë¦¬ë·°ëŠ” ì“¸ ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¡œ ì„¤ê³„(1:N)
- ìœ ì €ê°€ ê³ ë¥¸ ìƒ‰ì±„ëŠ” 5ê°œê°€ ìœ ì§€ë˜ë„ë¡ ì„¤ê³„(FIFO)



### ì˜í™”

- ì œëª©, ì¤„ê±°ë¦¬, TMDB í‰ì , ê°œë´‰ì¼, í¬ìŠ¤í„° url, í˜„ì¬ ì‚¬ì´íŠ¸ ìœ ì €ë“¤ì˜ í‰ì , ì˜ˆê³ í¸ urlë¡œ êµ¬ì„±
- ì˜ˆê³ í¸ì€ ì‚¬ì´íŠ¸ì—ì„œ ë°”ë¡œ ë‚˜ì˜¬ ìˆ˜ ìˆë„ë¡ ìœ íŠœë¸Œ ì˜¤í”ˆ APIë¥¼ í™œìš©í•˜ì—¬ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì €ì¥
- Naverì™€ TMDB ì˜¤í”ˆ API ì†¡ìˆ˜ì‹ ì„ í†µí•´ í•„ìš”í•œ ì •ë³´ë“¤ì„ ì¶”ì¶œ í›„ Django ORMì„ í†µí•´ ì£¼ì…
- í€´ì¦ˆì™€ 1:N ë§¤í•‘, ë¦¬ë·° ë° í•œì¤„í‰ê³¼ 1:N ë§¤í•‘
- ì˜í™” í…Œì´ë¸”ì˜ rowê°€ ë§ì•„ì ¸, ìƒ‰ì±„ì— ëŒ€í•œ ë°ì´í„°ëŠ” 1:1 ë§¤í•‘ìœ¼ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ì— ì„¤ê³„(ë¡œë“œì‹œ ìºì‹±ì„ í†µí•œ ì¿¼ë¦¬ìµœì í™”)



### ìƒ‰ì±„

- ì¶”ì¶œí•œ 5ê°€ì§€ì˜ ëŒ€í‘œìƒ‰ì˜ RGB ê°’ì„ ì €ì¥
- í´ëŸ¬ìŠ¤í„°ë§ ì§ì „ ë°ì´í„°ëŠ” ê°€ì‹œì„±ê³¼ ì‚¬ìš©ìì˜ ì‹ ë¢°ë¥¼ ì–»ê¸° ìœ„í•´ color_urlì— ì£¼ì†Œ í˜•íƒœë¡œ ì €ì¥



### í€´ì¦ˆ 

* ìœ ì €ê°€ í€´ì¦ˆë¥¼ ì§ì ‘ ì¶œì œí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ (1:N)
* ë§ì¶˜ í€´ì¦ˆëŠ” ë” ì´ìƒ ë³´ì´ì§€ ì•Šë„ë¡ ì„¤ê³„í•˜ê¸° ìœ„í•´ í€´ì¦ˆ ë³„ ë§ì¶˜ ìœ ì €ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸” ë³„ë„ë¡œ êµ¬ì„±

<br>

```
final-pjt
â”œâ”€â”€ accounts/
â”‚   â”œâ”€â”€ migrations
â”‚		â”‚		â””â”€â”€ ...
â”‚   â”œâ”€â”€ templates/accounts
â”‚		â”‚		â””â”€â”€ ...
â”‚   â””â”€â”€ static/accounts
â”‚				â””â”€â”€ ...
â”œâ”€â”€ movies/
â”‚   â”œâ”€â”€ migrations
â”‚		â”‚		â””â”€â”€ ...
â”‚   â”œâ”€â”€ templates/movies
â”‚		â”‚		â””â”€â”€ ...
â”‚   â””â”€â”€ static/movies
â”‚				â””â”€â”€ ...
â”œâ”€â”€ final-pjt/
â”‚		â””â”€â”€ ...
â”œâ”€â”€ staticfiles/static
â”‚   â”œâ”€â”€ css
â”‚		â”‚		â””â”€â”€ ...
â”‚   â”œâ”€â”€ favicon
â”‚		â”‚		â””â”€â”€ ...
â”‚   â”œâ”€â”€ images
â”‚		â”‚		â””â”€â”€ ...
â”‚   â”œâ”€â”€ videos
â”‚		â”‚		â””â”€â”€ ...				
â”‚   â””â”€â”€ ...
â”œâ”€â”€ templates
â”‚   â””â”€â”€ base.html
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ db.sqlite3
â””â”€â”€ requirements.txt
```

<br>

## ğŸª Python, Django ORMì„ í™œìš©í•œ ë°ì´í„° ì£¼ì…

#### Static ë°ì´í„°ì¸ ì˜í™” ë°ì´í„°ë¥¼ ì¬êµ¬ì„±í•´ì„œ DBì— ì¶”ê°€í•  í•„ìš”

- í´ëŸ¬ìŠ¤í„°ë§ ë° RGB ë„ì¶œëœ ë°ì´í„°
- TMDB API ì˜í™”ì •ë³´
- Youtube Trailer URL



#### í´ëŸ¬ìŠ¤í„°ë§ ì „ í”„ë ˆì„ ì‚¬ì§„ ì£¼ì…

![Untitled](README.assets/untitled.png)



#### ìƒ‰ì±„ë°ì´í„° ì£¼ì…

![erd](README.assets/untitled1.png)



![erd](README.assets/untitled2.png)



#### Naver ë° TMDB, Youtube ë°ì´í„° ì •ì œ í›„ DBì— ì£¼ì…

*  Naver ì˜í™” ë°ì´í„°

  ![erd](README.assets/untitled3.png)

* TMDB ì˜í™” ë°ì´í„°

  ![erd](README.assets/untitled4.png)

* Youtube ì˜ˆê³ í¸ ë°ì´í„°

  ![erd](README.assets/untitled5.png)



#### DB ì£¼ì… ê²°ê³¼

* ì˜í™” ìƒ‰ì±„ ë°ì´í„° (RGB * 5)

  ![erd](README.assets/untitled6.png)

* ì˜í™” ë°ì´í„°

  ![erd](README.assets/untitled7.png)

* ì˜í™” ì •ë³´ ë°ì´í„°

  ![erd](README.assets/untitled8.png)

<br>

## ğŸ‘±ğŸ¼â€â™‚ï¸ ë©”ì¸ í˜ì´ì§€ ê´€ë ¨ ì½”ë“œ

### ì˜í™” ë©”ì¸ ì½”ë“œ

**ğŸš£â€â™‚ï¸** https://github.com/Gkuer/Gkuer9-PrismFilmStudio/blob/master/movies/views.py



##### ìƒ‰ì±„ìˆœ ì •ë ¬ì„ ì œì™¸í•œ í‰ì ìˆœ, ìµœì‹ ìˆœ, ê²€ìƒ‰ ì½”ë“œ

```python
# Order by TMDB_Grade + User_Grade
    if mode == 2:
        for movie in movies:
            naver_score = movie.naver_grade
            user_score = 0 
            for comment in movie.comments.all():
                user_score += comment.grade
            if user_score:
                user_score = round((user_score / movie.comment_count),1) * 2
                score = (naver_score + user_score) / 2
            else:
                score = naver_score
            res_movies.append([movie, score])
    
    # Order by Release Date
    elif mode == 3:
        for movie in movies:
            score = movie.release_date
            res_movies.append([movie, score])
    
    # Order by Search
    elif mode == 4:
        datas = request.GET['searchData'].split()                      # Input Data list
        for movie in movies:                                           # query in title : +10, query in overview +1
            temp_cnt = 0
            title = movie.title
            overview = movie.overview
            for data in datas:
                if data in title:
                    temp_cnt += 10
                if data in overview:
                    temp_cnt += 1
            if temp_cnt >= 1:                                          # If query in title, content, Can be Searched
                res_movies.append([movie,temp_cnt])
```

<br>

## ğŸ‘±ğŸ¼â€â™‚ï¸ Blob ë°ì´í„°ë¥¼ í™œìš©í•œ ë“œë¡œì‰ ë¦¬ë·° ë° í€´ì¦ˆ ê¸°ëŠ¥ êµ¬í˜„

![erd](README.assets/untitled9.png)



#### ì‚¬ìš©ìê°€ ê·¸ë¦° ê·¸ë¦¼ì„ ì‚¬ìš©ì ë¡œì»¬ì— ì €ì¥í•˜ì§€ ì•Šê³  ë°ì´í„°ë¥¼ ë°”ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•´ Blob ë°ì´í„° ë³€í™˜ í›„ Promise ë°©ì‹ìœ¼ë¡œ Axios í™œìš©



##### Blob ë°ì´í„° ë³€í™˜

```javascript
var imgDataUrl = drawCanvas.toDataURL('image/png');
var binaryData = atob(imgDataUrl.split(',')[1]);                           	 	   // Blob ë°ì´í„° ë³€í™˜
var array = [];
for (var i = 0; i < binaryData.length; i++) {
    array.push(binaryData.charCodeAt(i));
  }
var blob = new Blob([new Uint8Array(array)], {type: 'image/png'});
```



##### Response

views.py

```python
@login_required
@require_http_methods(['GET','POST'])
def review_create(request, movie_pk):
    movie = Movie.objects.get(pk = movie_pk)
    
    # Profile Color Create
    colors = request.user.usercolorrecord_set.all()                # Color List
    last_color = colors[len(colors)-1]                             # Picked Color
    colors = reversed(colors)                                      # Color Sort(Recently)
    
    if request.method == "POST":
        form = ReviewForm(request.POST, request.FILES)
        if form.is_valid():
            review = form.save(commit=False)
            review.movie = movie
            review.user = request.user
            review.save()
            request.user.point += 30
            request.user.save()
            return redirect('movies:detail', movie_pk)
    else:
        form = ReviewForm()
    context = {
        'movie': movie,
        'form': form,
        'last_color': last_color,
        'colors': colors,
    }
    return render(request, 'movies/review_create.html', context)
```

<br>

models.py

```python
class Review(models.Model):
    movie = models.ForeignKey(Movie, on_delete=models.CASCADE, related_name="reviews")
    title = models.CharField(max_length=50)
    content = models.TextField()
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    draw = models.ImageField(blank=True, upload_to='images/')
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
```

<br>

## **ğŸ‘±ğŸ¼â€â™‚ï¸** Web Speech API ë° Ajax í†µì‹ ì„ í™œìš©í•œ ìŒì„±ì¸ì‹ êµ¬í˜„

> ê¸°ì¡´ì—ëŠ” ë„¤ì´ë²„, ì¹´ì¹´ì˜¤ ë‘˜ ì¤‘ í•˜ë‚˜ì˜ APIë¥¼ ì‚¬ìš©í•´ì„œ Axios, Promise ë°©ì‹ìœ¼ë¡œ API / Django View 2ê°œì™€ í†µì‹ í•˜ì—¬ ë¡œì§ì„ ì²˜ë¦¬í•˜ë ¤ê³  êµ¬ìƒ
>
> í•˜ì§€ë§Œ, IEì™€ Chromeì—ì„œ ë™ì‘í•˜ëŠ” Web Speech APIì˜ ìŒì„±ì¸ì‹ ì‹ ë¢°ë„(í•œêµ­ì–´, 92%)ì„ í™•ì¸ í›„ í•´ë‹¹ API ì‚¬ìš©ì— ì ‘ê·¼



> CSR = Naver CLOVA Speech Recognition, K_TTS = Kakao Speech-to-Text system, WSA = Web Speech API



![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-11-25 á„‹á…©á„’á…® 12.48.59](README.assets/mdn-3040086.png)

#### Web Speech API ì„ ì •

* í•œêµ­ì–´ ì‹ ë¢°ë„ ìˆœì€ CSR > K_TTS > Web Speech API

* ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ë¡œì§ìˆœì„œëŠ”

  * CSR, K_TTSì˜ ê²½ìš°,
    * Template(ì‚¬ìš©ì ìŒì„± ë…¹ìŒ) > Axios(JS, íŒŒì¼ë¡œ ë³€í™˜ í›„ ì „ì†¡) > CSR, K_TTS(ë°ì´í„° ì²˜ë¦¬í›„ Response) > Axios(ë°ì´í„° ìˆ˜ì‹ ) > Django View(ë°ì´í„° ì „ì†¡) > Django View(ë°ì´í„° ì²˜ë¦¬ í›„ Response) > Axios(ì‘ì—… í›„ Templateì²˜ë¦¬)
  * WSAì˜ ê²½ìš°,
    * ì‚¬ìš©ì ìŒì„± ë…¹ìŒ(Template) > WSA(ë°”ë¡œ ì²˜ë¦¬ í›„ í…ìŠ¤íŠ¸ ì¶”ì¶œ í›„ ì „ì†¡)  > Django View(ë°ì´í„° ì²˜ë¦¬ í›„ Response) > Axos(ì‘ì—… í›„ Templateì²˜ë¦¬)

  ì•ˆ ê·¸ë˜ë„ ë§ì€ ë°ì´í„°ê°€ ì—…ë¡œë“œ ë˜ì–´ì•¼í•˜ê³ , í†µì‹ ë„ ë§ì´ í•˜ëŠ” ì‚¬ì´íŠ¸ì—ì„œ CSR, K_TTS ë³´ë‹¤ëŠ” WSAê°€ í›¨ì”¬ ê°€ë²¼ìš¸ ê²ƒì´ë¼ ì˜ˆì¸¡

* êµ¬í˜„ ì‚¬ì´íŠ¸ì—ì„œ í•„ìš”í•œ ê²ƒì€ ì–´ëŠì •ë„ì˜ ì¸ì‹ë¥  ì´ìƒ

  ìŒì„±ì¸ì‹ ì²˜ë¦¬ê°€ ëª©ì ì¸ ì‚¬ì´íŠ¸ê°€ ì•„ë‹ˆë©°, ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ìš”ì²­ì´ ë§ì§€ ì•Šì•˜ë‹¤. ë”°ë¼ì„œ WSAì˜ ì‹ ë¢°ë„ 92%ëŠ” ì¶©ë¶„í•˜ë‹¤ê³  íŒë‹¨



![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-11-25 á„‹á…©á„’á…® 12.58.12](README.assets/voice-3040086.png)



##### Request

```javascript
axios({
  method: 'GET',
  url: processURL,
  params: {
    data: voiceText.textContent,
  }
})
  .then(function (response) {
  const res = response.data.res // Number for Recognition
  if (res != 0 && res <= 3) {
    // href to Main by Sorting
    voiceAnswer.classList.remove('d-none')
    voiceAnswer.innerText = "ì•Œê² ì–´ìš”, ë°”ë¡œ ì‹¤í–‰í• ê²Œìš”."
    setTimeout(function() {
      window.location.href = `/movies/index/${res}`
    }, 1000);  
  } else if (res >= 4) {
    if (res == 4) {
      // Search
      let query = response.data.query
```



##### Response

```python
def voice_process(request):
    data = request.GET['data']
    responsable = {"ë©”ì¸": 1, "ë§¤ì¸": 1, "ìƒ‰ì²´": 1, "ìƒ‰ì±„": 1, "í‰ì ": 2, "ìµœì‹ ": 3, "ê²€ìƒ‰": 4, "ë’¤ë¡œ":5, "ë¡œê·¸": 6}
    res, query = 0, ""
    
    for key, value in responsable.items():
        if key in data:
            if key == "ê²€ìƒ‰":
                query = str(data[1:data.index("ê²€ìƒ‰")])
            res = value
            break
        
    context = {
        'res' : res,
        'query' : query,
    }
    return JsonResponse(context)
```

<br>

## ğŸš£â€â™‚ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìºì‹±ì„ í™œìš©í•œ ì¿¼ë¦¬ ìµœì í™”

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-04-02 á„‹á…©á„’á…® 10.08.48](README.assets/query.png)



#### Django ORM ì¿¼ë¦¬ ìµœì í™” í•¨ìˆ˜ ì‚¬ìš©

- **prefetched_realated - (ì—­ì°¸ì¡° ë°ì´í„° ì‚¬ì „ ë“±ë¡)**
- **annotate - (count ì‚¬ì „ ë“±ë¡)**
- **filter, exclude ë“± - ê³„ì‚° ìµœì í™”**

```python
# index/views.py

# Exclude Already Watched Movies(Query Optimization)
    already_watched_movies = set()

    users_moviecomments = MovieComment.objects.filter(user=request.user.pk).values('movie')
    for users_moviecomment in users_moviecomments:
        already_watched_movies.add(users_moviecomment['movie'])

    users_reviews = Review.objects.filter(user=request.user.pk).values('movie')
    for users_review in users_reviews:
        already_watched_movies.add(users_review['movie'])

    # Query Optimization - movie.color_set + Exclude Already Watched Movies + movie.comments_set + movie.comments.all.count()
    movies = Movie.objects.prefetch_related('color_set','comments')\
            .annotate(comment_count=Count('comments'))\
            .exclude(id__in=already_watched_movies)
    
    res_movies = []
```

<br>

## ğŸ‹ï¸ AWS(EC2), Nginx, Gunicorn, Cloud9ì„ í™œìš©í•œ ë°°í¬

> AWS EC2(Ubuntu Server 18.04 LTS)
>
> STATIC / MEDIA Files
>
> https://www.prismfilmstudio.com ([ç¾](https://ko.wiktionary.org/wiki/ç¾) ë°°í¬ ì¤‘ì§€)

![aws](README.assets/aws-3039730.png)

##### 

#### NGINX ì„¤ì •

- staticê³¼ media filesê°€ í¬í•¨ë˜ì–´ ìˆì–´ NGINXì—ì„œ ì„¤ì •
- staticì€ ê²½ë¡œë¥¼ staticfiles/staticìœ¼ë¡œ ì¡ì•„ì¤˜ì„œ staticfiles/static ê²½ë¡œë¥¼ ë§Œë“¤ì–´ ì¤Œìœ¼ë¡œì¨ í•´ê²°
- media íŒŒì¼ ì ‘ê·¼ì˜ ê²½ìš°ì—ëŠ” static ì²˜ëŸ¼ rootë¡œ ì¡ì•„ì£¼ë©´ ì—ëŸ¬ê°€ ë°œìƒ
- aliasë¡œ ë°”ê¿” mediaíŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„’á…® 3.12.20](README.assets/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„’á…® 3.12.20.png)



#### Django & Gunicorn ì„¤ì •

- Django - STATIC ROOT, ALLOWED_HOSTS, collectstatic ë°°í¬ ì…‹íŒ…
- Gunicorn ì„¤ì •

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„’á…® 3.12.36](data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1366 584"></svg>)



#### ë„ë©”ì¸ ì„¤ì • & í¬íŠ¸ ì„¤ì • & HTTPS

- [www](http://www/).~ ìœ¼ë¡œë„ ë“¤ì–´ì˜¬ ìˆ˜ ìˆë„ë¡ A type í•˜ë‚˜ ë” ê°œë°©

  ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-11-25 á„‹á…©á„’á…® 3.40.07](README.assets/domain-3040086.png)

* í•´ë‹¹ ì„¤ì •ì— ë”°ë¥¸ NGINX ì„¤ì •
* Cert Botì„ í™œìš©í•œ HTTPS ì„¤ì •

```shell
sudo snap install core; sudo snap refresh core
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
sudo certbot --nginx
```

* í¬íŠ¸ì„¤ì •

* 80 / 8000 / 443(https) => 0.0.0.0/0 / ::/0 ê°œë°©

  ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-11-25 á„‹á…©á„’á…® 3.44.55](README.assets/port-3040086.png)



<br>

## ğŸƒ íŒ€ì› ì •ë³´ ë° ì—…ë¬´ ë¶„ë‹´ ë‚´ì—­

#### ì†Œì†

* ##### SSAFY

#### ì´ë¦„

- ##### Eora

  - í´ëŸ¬ìŠ¤í„°ë§ / RGB Calculating / Tier / Quiz / DB / ì¿¼ë¦¬ ìµœì í™” / FE 

- ##### Gkuer

  - ìŒì„±ì¸ì‹ / ë“œë¡œì‰ / Design / Quiz / DB / FE / ì¿¼ë¦¬ ìµœì í™” / ë°°í¬

<br>

## ğŸ“– Reference

formdata - https://developer.mozilla.org/ko/docs/Web/API/FormData

ê·¸ë¦¼íŒ - https://github.com/shlee0882/painting-js

blob Data ë³€í™˜ - https://codebb.tistory.com/22

ë°°ê²½ í…Œë§ˆ - https://codepen.io/trending

Axios - https://github.com/axios/axios

Base -  https://edu.ssafy.com

ì»¬ëŸ¬ë°”ì½”ë“œ - https://happycoding.io/gallery/movie-colors/index

ëŒ€í‘œ ìƒ‰ì±„ - https://airows.com/culture/color-palettes-from-famous-movie-scenes

í‹°ì–´ ì‹œìŠ¤í…œ - https://www.acmicpc.net/, https://solved.ac/
